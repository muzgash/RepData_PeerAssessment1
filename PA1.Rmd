---
title: 'Reproducible Research: Peer Assessment 1'
output:
  html_document:
    keep_md: yes
  pdf_document: default
---
```{r loading libraries, echo=FALSE, results='hide'}
library(ggplot2)
```
## Loading and preprocessing the data
```{r}
tmp <- tempfile()
download.file("http://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip",tmp)
unzip(tmp)
unlink(tmp)
data<-read.csv("activity.csv")
```

## What is mean total number of steps taken per day?
Here is the histogram of the total number  of steps taken each day
```{r}
sbd<-aggregate(steps~date,data,sum)
qplot(sbd$steps, geom="histogram", xlab="Number of steps", ylab="Frequency")
```
```{r mean and median, echo=FALSE}
smean<-mean(sbd$steps)
smedian<-median(sbd$steps)
```
Where the mean is `r smean` and median is `r smedian`.

## What is the average daily activity pattern?
```{r}
sbi <- aggregate(steps ~ interval, data, mean)
qplot(sbi$interval,sbi$steps,geom = "line",xlab ="interval", ylab="Number of steps")
```
```{r max, echo=FALSE}
imax<-sbi[which.max(sbi$steps),1]
```
The 5-min interval which contains the maximum number of steps on average is `r imax`.

## Imputing missing values
```{r}
non_nas<-sum(!complete.cases(data))
imputed<-transform(data, steps = ifelse(is.na(data$steps), sbi$steps[match(data$interval, sbi$interval)], data$steps))
```


## Are there differences in activity patterns between weekdays and weekends?
